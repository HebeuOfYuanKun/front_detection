(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39f641ea"],{"1e4b":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container home"},[n("el-row",{attrs:{gutter:2}},[n("el-col",{attrs:{span:12}},[n("video",{staticStyle:{width:"1450px",height:"700px"},attrs:{id:"videoElement1",controls:"",autoplay:"",muted:""},domProps:{muted:!0}})])],1),n("el-row",[n("el-col",{attrs:{span:24}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","max-height":"250"}},[n("el-table-column",{attrs:{fixed:"",prop:"createTime",align:"center",label:"发生时间",width:"200"}}),n("el-table-column",{attrs:{prop:"eveType",align:"center",label:"事件类型",width:"300"}}),n("el-table-column",{attrs:{prop:"location",align:"center",label:"位置"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(n){return n.preventDefault(),e.queryRow(t.row.unsafeid,e.tableData)}}},[e._v(" 查看 ")])]}}])})],1)],1)],1),n("el-dialog",{attrs:{title:"查看信息",visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[n("el-form",{ref:"UnsafeInfo",attrs:{model:e.UnsafeInfo,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"发生时间:",prop:"eveType"}},[e._v(" "+e._s(e.UnsafeInfo.createTime)+" ")]),n("el-form-item",{attrs:{label:"位置:",prop:"location"}},[e._v(" "+e._s(e.UnsafeInfo.location)+" ")]),n("el-form-item",{attrs:{label:"图片",prop:"imgPath"}},[n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:"data:image/jpeg;base64,"+e.UnsafeInfo.imgPath,fit:"fill"}}),n("div",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.downloadImage(e.UnsafeInfo.unsafeid)}}},[e._v("下载图片")])],1)],1),n("el-form-item",{attrs:{label:"事件类型:",prop:"eveType"}},[e._v(" "+e._s(e.UnsafeInfo.eveType)+" ")])],1)],1)],1)},a=[],i=(n("99af"),n("b64b"),n("e7fc")),c=n.n(i),r=(n("fc78"),n("952a")),l=n.n(r),s=n("d7f8"),u={name:"index",data:function(){return{client:null,like:!0,tableData:[],version:"3.4.0",open:!1,UnsafeInfo:{location:""},form:{warning:""},options:[{value:"选项1",label:"人"},{value:"选项2",label:"机器"},{value:"选项3",label:"车辆"}],videoOptions:{autoplay:!0,controls:!0,sources:[{src:"../assets/example.mp4",type:"video/mp4"}]}}},mounted:function(){this.initMqtt();var e=new l.a({element:document.getElementById("videoElement1"),frameTracking:!0,updateOnStart:!0,updateOnFocus:!0,reconnect:!0,reconnectInterval:2e3}),t=e.init({type:"flv",url:"http://127.0.0.1:8080/live/livestream.flv",isLive:!0},{enableStashBuffer:!1,stashInitialSize:128});t.play()},beforeDestroy:function(){this.client.end(),this.client=null},methods:{flv_destroy:function(e){e.pause(),e.unload(),e.detachMediaElement(),e.destroy()},publish:function(e,t){this.client.connected&&this.client.publish(e,t,{qos:0},(function(e){}))},initMqtt:function(){var e=this,t={connectTimeout:4e3,clientId:"cumt/message/"+Math.random(),username:"yuankun",password:"123456yk"};this.client=c.a.connect("ws://localhost:8083/mqtt",t);var n="cumt/message";this.client.on("connect",(function(t){e.form.warning=e.form.warning+"连接成功\r"})),this.client.subscribe(n,{qos:0},(function(e){})),this.client.subscribe("cumt/tips",{qos:0},(function(e){})),this.client.on("message",(function(t,n){if(console.log("收到来自：".concat(t," 的消息：").concat(n)),"cumt/message"==t){var o=JSON.parse("".concat(n));e.tableData.unshift(o)}if("cumt/tips"==t){var a=JSON.parse("".concat(n));500==a.code&&e.$modal.msgError(a.msg),200==a.code&&e.$modal.msgSuccess(a.msg)}})),this.client.on("reconnect",(function(e){console.log("正在重连",e)})),this.client.on("error",(function(t){e.form.warning=e.form.warning+"连接失败\r",console.log("连接失败",t)}))},initVideo:function(){this.$video(myVideo,{controls:!0,autoplay:"muted",preload:"auto",width:"400px",height:"350px"})},goTarget:function(e){window.open(e,"_blank")},format:function(e){return 100===e?"满":"".concat(e,"%")},queryRow:function(e,t){var n=this;this.open=!0,Object(s["d"])(e).then((function(e){n.UnsafeInfo=e.data}))},downloadImage:function(e){Object(s["c"])(e).then((function(e){}))}}},d=u,f=(n("b80c"),n("2877")),m=Object(f["a"])(d,o,a,!1,null,"0d76edba",null);t["default"]=m.exports},3:function(e,t){},4:function(e,t){},5:function(e,t){},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){},b80c:function(e,t,n){"use strict";n("d35e")},d35e:function(e,t,n){},d7f8:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return u}));n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("88a7"),n("271a"),n("5494");var o=n("b775");function a(e){return Object(o["a"])({url:"/message/warning/list",method:"get",params:e})}var i=function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=o?window.URL.createObjectURL(new Blob([e],{type:"application/zip"})):window.URL.createObjectURL(new Blob([e],{type:"image/jpeg"}));var a=document.createElement("a");a.style.display="none",a.href=n,a.setAttribute("download",t),document.body.appendChild(a),a.click(),document.body.removeChild(a)};function c(e){Object(o["a"])({url:"/message/warning/downloadImage/"+e,method:"get",params:{fileName:e,delete:!1},responseType:"blob"}).then((function(t){i(t,e)})).catch((function(e){console.error("Download file failed:",e)}))}function r(e){return Object(o["a"])({url:"/message/warning/getInfo/"+e,method:"get"})}function l(e){return Object(o["a"])({url:"/message/warning/add",method:"post",data:e})}function s(e){return Object(o["a"])({url:"/message/warning/edit",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/message/warning/remove/"+e,method:"get"})}}}]);